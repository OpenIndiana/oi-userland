From: Markus Koschany <apo@debian.org>
Date: Mon, 31 Jul 2017 19:59:39 +0200
Subject: CVE-2017-9726

Bug-Debian: https://bugs.debian.org/869915
Bug-Upstream: http://bugs.ghostscript.com/show_bug.cgi?id=698055
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=7755e67116e8973ee0e3b22d653df026a84fa01b
---
 base/ttinterp.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/base/ttinterp.c b/base/ttinterp.c
index 587ee92..c82bc1b 100644
--- a/base/ttinterp.c
+++ b/base/ttinterp.c
@@ -3768,7 +3768,8 @@ static int nInstrCount=0;
 
     point = (Int)args[0];
 
-    if ( BOUNDS( args[0], CUR.zp1.n_points ) )
+    if ( BOUNDS( args[0], CUR.zp1.n_points ) ||
+         BOUNDS( CUR.GS.rp0, CUR.zp0.n_points) )
     {
         /* Current version of FreeType silently ignores this out of bounds error
          * and drops the instruction, see bug #691121
