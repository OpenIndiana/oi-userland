Description: CVE-2016-7977: .libfile doesn't check PermitFileReading array, allowing remote file disclosure
Origin: upstream, http://git.ghostscript.com/?p=ghostpdl.git;h=8abd22010eb4db0fb1b10e430d5f5d83e015ef70
Bug: http://bugs.ghostscript.com/show_bug.cgi?id=697169
Bug-Debian: https://bugs.debian.org/839841
Forwarded: not-needed
Author: Chris Liddell <chris.liddell@artifex.com>
Reviewed-by: Salvatore Bonaccorso <carnil@debian.org>
Reviewed-by: Emily Ratliff <emily.ratliff@canonical.com>
Last-Update: 2016-11-30
---

--- ghostscript-9.05~dfsg.orig/psi/zfile.c
+++ ghostscript-9.05~dfsg/psi/zfile.c
@@ -1018,6 +1018,9 @@ lib_file_open(gs_file_path_ptr  lib_path
     gs_main_instance *minst = get_minst_from_memory(mem);
     int code;
 
+    if (i_ctx_p && starting_arg_file)
+        i_ctx_p->starting_arg_file = false;
+
     /* when starting arg files (@ files) iodev_default is not yet set */
     if (iodev == 0)
         iodev = (gx_io_device *)gx_io_device_table[0];
