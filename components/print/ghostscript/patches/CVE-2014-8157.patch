# Description: fix denial of service or code execution via off-by-one
# Origin: vendor, http://pkgs.fedoraproject.org/cgit/jasper.git/tree/jasper-CVE-2014-8157.patch
# Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=1179282
# Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775970

diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' ghostscript-8.71.dfsg.1~/jasper/src/libjasper/jpc/jpc_dec.c ghostscript-8.71.dfsg.1/jasper/src/libjasper/jpc/jpc_dec.c
--- ghostscript-8.71.dfsg.1~/jasper/src/libjasper/jpc/jpc_dec.c	2015-01-22 13:04:53.000000000 -0500
+++ ghostscript-8.71.dfsg.1/jasper/src/libjasper/jpc/jpc_dec.c	2015-01-22 13:04:58.765956946 -0500
@@ -497,7 +497,7 @@
 		dec->curtileendoff = 0;
 	}
 
-	if (JAS_CAST(int, sot->tileno) > dec->numtiles) {
+	if (JAS_CAST(int, sot->tileno) >= dec->numtiles) {
 		jas_eprintf("invalid tile number in SOT marker segment\n");
 		return -1;
 	}
