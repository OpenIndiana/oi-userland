From: Markus Koschany <apo@debian.org>
Date: Mon, 31 Jul 2017 20:07:17 +0200
Subject: CVE-2017-9739

Bug-Debian: https://bugs.debian.org/869910
Bug-Upstream: https://bugs.ghostscript.com/show_bug.cgi?id=698063
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=c501a58f8d5650c8ba21d447c0d6f07eafcb0f15
---
 base/ttinterp.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/base/ttinterp.c b/base/ttinterp.c
index c82bc1b..b4d6fda 100644
--- a/base/ttinterp.c
+++ b/base/ttinterp.c
@@ -1791,6 +1791,12 @@ static int nInstrCount=0;
 
   static void  Ins_JMPR( INS_ARG )
   {
+    if ( BOUNDS(CUR.IP + args[0], CUR.codeSize ) )
+    {
+      CUR.error = TT_Err_Invalid_Reference;
+      return;
+    }
+
     CUR.IP      += (Int)(args[0]);
     CUR.step_ins = FALSE;
 
