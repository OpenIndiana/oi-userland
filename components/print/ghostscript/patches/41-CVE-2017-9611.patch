From: Markus Koschany <apo@debian.org>
Date: Mon, 31 Jul 2017 19:55:43 +0200
Subject: CVE-2017-9611

Bug-Debian: https://bugs.debian.org/869917
Bug-Upstream: https://bugs.ghostscript.com/show_bug.cgi?id=698024
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=c7c55972758a93350882c32147801a3485b010fe
---
 base/ttinterp.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/base/ttinterp.c b/base/ttinterp.c
index 2a95884..93cc850 100644
--- a/base/ttinterp.c
+++ b/base/ttinterp.c
@@ -3856,7 +3856,8 @@ static int nInstrCount=0;
     /* XXX: UNDOCUMENTED! cvt[-1] = 0 always */
 
     if ( BOUNDS( args[0],   CUR.zp1.n_points ) ||
-         BOUNDS( args[1]+1, CUR.cvtSize+1 )    )
+         BOUNDS( args[1]+1, CUR.cvtSize+1 )    ||
+         BOUNDS(CUR.GS.rp0,  CUR.zp0.n_points) )
     {
       CUR.error = TT_Err_Invalid_Reference;
       return;
