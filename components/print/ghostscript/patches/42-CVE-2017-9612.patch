From: Markus Koschany <apo@debian.org>
Date: Mon, 31 Jul 2017 19:58:39 +0200
Subject: CVE-2017-9612

Bug-Debian: https://bugs.debian.org/869916
Bug-Upstream: https://bugs.ghostscript.com/show_bug.cgi?id=698026
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=98f6da60b9d463c617e631fc254cf6d66f2e8e3c
---
 base/ttinterp.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/base/ttinterp.c b/base/ttinterp.c
index 93cc850..587ee92 100644
--- a/base/ttinterp.c
+++ b/base/ttinterp.c
@@ -4127,7 +4127,9 @@ static int nInstrCount=0;
     Int         point;
     (void)args;
 
-    if ( CUR.top < CUR.GS.loop )
+    if ( CUR.top < CUR.GS.loop ||
+         BOUNDS(CUR.GS.rp1, CUR.zp0.n_points) ||
+         BOUNDS(CUR.GS.rp2, CUR.zp1.n_points))
     {
       CUR.error = TT_Err_Invalid_Reference;
       return;
