From: Markus Koschany <apo@debian.org>
Date: Mon, 31 Jul 2017 20:04:05 +0200
Subject: CVE-2017-9727

Bug-Debian: https://bugs.debian.org/869913
Bug-Upstream: http://bugs.ghostscript.com/show_bug.cgi?id=698056
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commit;h=937ccd17ac65935633b2ebc06cb7089b91e17e6b
---
 base/gxttfb.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/base/gxttfb.c b/base/gxttfb.c
index 418d20c..1cc03fc 100644
--- ghostscript-9.00/base/gxttfb.c.~1~	2017-08-29 12:22:47.831551886 +0000
+++ ghostscript-9.00/base/gxttfb.c	2017-08-29 12:24:07.410516843 +0000
@@ -77,7 +77,8 @@
     if (!r->error) {
 	if (r->extra_glyph_index != -1) {
 	    q = r->glyph_data.bits.data + r->pos;
-	    r->error = (r->glyph_data.bits.size - r->pos < n ? 
+	    r->error = ((r->pos >= r->glyph_data.bits.size ||
+                            r->glyph_data.bits.size - r->pos < n) ?
 			    gs_note_error(gs_error_invalidfont) : 0);
             if (r->error == 0)
                 memcpy(p, q, n);
