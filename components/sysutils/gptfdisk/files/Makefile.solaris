CC?=gcc
CXX?=g++
INSTALL?=install
CFLAGS+=-D_FILE_OFFSET_BITS=64
CXXFLAGS+=-Wall -D_FILE_OFFSET_BITS=64
LDFLAGS+=
LIB_NAMES=crc32 support guid gptpart mbrpart basicmbr mbr gpt bsd parttypes attributes diskio diskio-unix
MBR_LIBS=support diskio diskio-unix basicmbr mbrpart
LIB_OBJS=$(LIB_NAMES:=.o)
MBR_LIB_OBJS=$(MBR_LIBS:=.o)
LIB_HEADERS=$(LIB_NAMES:=.h)
DEPEND= makedepend $(CXXFLAGS)
BINDIR=${bindir}
MANDIR=${mandir}
DOCDIR=${docdir}

all:	gdisk cgdisk sgdisk fixparts

gdisk:	$(LIB_OBJS) gdisk.o gpttext.o
	$(CXX) $(LIB_OBJS) gdisk.o gpttext.o $(LDFLAGS) -luuid -o gdisk

cgdisk: $(LIB_OBJS) cgdisk.o gptcurses.o
	$(CXX) $(LIB_OBJS) cgdisk.o gptcurses.o $(LDFLAGS) -luuid -lncurses -o cgdisk

sgdisk: $(LIB_OBJS) sgdisk.o gptcl.o
	$(CXX) $(LIB_OBJS) sgdisk.o gptcl.o $(LDFLAGS) -luuid -lpopt -o sgdisk

fixparts: $(MBR_LIB_OBJS) fixparts.o
	$(CXX) $(MBR_LIB_OBJS) fixparts.o $(LDFLAGS) -o fixparts

lint:	#no pre-reqs
	lint $(SRCS)

clean:	#no pre-reqs
	rm -f core *.o *~ gdisk sgdisk

# what are the source dependencies
depend: $(SRCS)
	$(DEPEND) $(SRCS)

$(OBJS):
	$(CRITICAL_CXX_FLAGS) 

# DO NOT DELETE

install:
	$(INSTALL) -D gdisk    $(DESTDIR)$(BINDIR)/gdisk
	$(INSTALL) -D cgdisk   $(DESTDIR)$(BINDIR)/cgdisk
	$(INSTALL) -D sgdisk   $(DESTDIR)$(BINDIR)/sgdisk
	$(INSTALL) -D fixparts $(DESTDIR)$(BINDIR)/fixparts
	$(INSTALL) -D gdisk.8    $(DESTDIR)$(MANDIR)/gdisk.8
	$(INSTALL) -D cgdisk.8   $(DESTDIR)$(MANDIR)/cgdisk.8
	$(INSTALL) -D sgdisk.8   $(DESTDIR)$(MANDIR)/sgdisk.8
	$(INSTALL) -D fixparts.8 $(DESTDIR)$(MANDIR)/fixparts.8
	$(INSTALL) -D gdisk.html    $(DESTDIR)$(DOCDIR)/gdisk.html
	$(INSTALL) -D cgdisk.html   $(DESTDIR)$(DOCDIR)/cgdisk.html
	$(INSTALL) -D sgdisk.html   $(DESTDIR)$(DOCDIR)/sgdisk.html
	$(INSTALL) -D fixparts.html $(DESTDIR)$(DOCDIR)/fixparts.html
