Kindly provided by Joyent:

https://github.com/joyent/illumos-extra/pull/49/

This patch may be amended in the future to harden the fix.

diff --git a/encoding.c b/encoding.c
index e5db3e7..1ce38b4 100644
--- a/encoding.c
+++ b/encoding.c
@@ -1357,6 +1357,9 @@ struct mchar *mc;
   int root, i, c1;
   int isdouble;
 
+  if (c > 0x801)
+    return;
+
   c1 = mc->image | (mc->font << 8) | mc->fontx << 16;
   isdouble = c1 >= 0x1100 && utf8_isdouble(c1);
   if (!combchars)
