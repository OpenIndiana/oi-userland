# Description: fix denial of service via different line lengths
# Origin: backport, http://git.gnupg.org/cgi-bin/gitweb.cgi?p=gpgme.git;a=commit;h=2cbd76f7911fc215845e89b50d6af5ff4a83dd77
# Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=756651

diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' gpgme1.0-1.2.0~/src/engine-gpgsm.c gpgme1.0-1.2.0/src/engine-gpgsm.c
--- src/engine-gpgsm.c	2009-06-17 08:36:07.000000000 -0400
+++ src/engine-gpgsm.c	2014-08-01 09:45:02.165096307 -0400
@@ -959,7 +959,7 @@
 	      else
 		{
 		  *aline = newline;
-		  gpgsm->colon.attic.linesize += linelen + 1;
+		  gpgsm->colon.attic.linesize = *alinelen + linelen + 1;
 		}
 	    }
 	  if (!err)
