#
# This file and its contents are supplied under the terms of the
# Common Development and Distribution License ("CDDL"), version 1.0.
# You may only use this file in accordance with the terms of version
# 1.0 of the CDDL.
#
# A full copy of the text of the CDDL should have accompanied this
# source.  A copy of the CDDL is also available via the Internet at
# http://www.illumos.org/license/CDDL.
#

#
# Copyright 2012, Andrzej Szeszo
# Copyright 2017, Jim Klimov
#

<transform file path=usr.*/man/.+ -> default mangler.man.stability uncommitted>

<transform file -> add pkg.depend.bypass-generate usr/gcc/3.*>
<transform file -> add pkg.depend.bypass-generate usr/sfw/lib(.*)/libgcc_s.so.1>
<transform file -> add pkg.depend.bypass-generate usr/sfw/lib(.*)/libstdc\\+\\+\\.so.*>

<transform dir path=usr$ -> default group sys>
<transform dir path=usr/share$ -> default group sys>
<transform dir path=usr/share/applications$ -> default group other>
<transform dir path=usr/share/control-center-2.0$ -> default group other>
<transform dir path=usr/share/control-center-2.0/capplets$ -> default group other>
<transform dir path=usr/share/doc$ -> default group other>
<transform dir path=usr/share/icons$ -> default group other>

<transform file path=.*kernel/drv/.+\.conf -> default mode 0444>
<transform file path=.*kernel/drv/.+ -> default mode 0555>
<transform file path=.*kernel/drv/$(MACH64)/.+ -> default mode 0555>
<transform file path=.*kernel/misc/.+\.conf -> default mode 0444>
<transform file path=.*kernel/misc/.+ -> default mode 0555>
<transform file path=.*kernel/misc/$(MACH64)/.+ -> default mode 0555>

set name=pkg.fmri \
    value=pkg:/driver/graphics/nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION)@$(IPS_COMPONENT_VERSION),$(BUILD_VERSION)
set name=pkg.summary value="NVIDIA Graphics System Software"
set name=pkg.description \
    value="X and OpenGL Drivers for NVIDIA Quadro graphics, driver $(NVIDIA_DRIVER_MAJOR_VERSION) series"
set name=description value="NVIDIA Graphics System Software"
set name=info.classification \
    value=org.opensolaris.category.2008:Drivers/Display
set name=org.opensolaris.consolidation value=$(CONSOLIDATION)
set name=info.upstream-url value=$(COMPONENT_PROJECT_URL)
set name=info.source-url value=$(COMPONENT_ARCHIVE_URL)
set name=variant.opensolaris.zone value=global value=nonglobal

license driver-graphics-nvidia.license license="NVIDIA license"

##### Files, dirs and mediation symlinks provided by original packaging
##### and manipulated by our Makefile; mostly matches the generated
##### sample-manifest.p5m with a few differences: "link" objects made
##### after the dirs or files they link to; NVIDIA_DRIVER_MAJOR_VERSION
##### replaced the hardcoded numbers; NVIDIA_MEDIATOR added to symlinks
##### where mediation was intended; original recipe's IPS modifiers
##### added back to some actions.

file path=kernel/drv/$(MACH64)/nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION) \
     reboot-needed=true variant.opensolaris.zone=global group=sys
file path=kernel/drv/nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION) \
     reboot-needed=true variant.opensolaris.zone=global group=sys
file path=kernel/drv/nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION).conf \
     preserve=true \
     reboot-needed=false variant.opensolaris.zone=global group=sys
link path=kernel/drv/$(MACH64)/nvidia \
     target=nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)
link path=kernel/drv/nvidia \
     target=nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)
link path=kernel/drv/nvidia.conf \
     target=nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION).conf $(NVIDIA_MEDIATOR)

file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/GL/gl.h
file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/GL/glext.h
file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/GL/glx.h
file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/GL/glxext.h
file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/vdpau/vdpau.h
file path=usr/X11/include/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/vdpau/vdpau_x11.h
link path=usr/X11/include/NVIDIA \
     target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libGL.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-glcore.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-tls.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libvdpau_nvidia.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libGL.so.1
# Note: no 64-bit XvMC in tarball, and it is not served in other branches at all
###file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libXvMCNVIDIA.a
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libXvMCNVIDIA.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-glcore.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-tls.so.1
file path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libvdpau_nvidia.so.1
link path=usr/X11/lib/NVIDIA \
     target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/X11/lib/X11/getconfig/nvda-$(NVIDIA_DRIVER_MAJOR_VERSION).cfg
link path=usr/X11/lib/X11/getconfig/nvda.cfg \
     target=nvda-$(NVIDIA_DRIVER_MAJOR_VERSION).cfg \
     $(NVIDIA_MEDIATOR)

file path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-wfb.so.1 \
     pkg.debug.depend.path=usr/lib/$(MACH64)
file path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-wfb.so.1 \
     pkg.debug.depend.path=usr/lib
link path=usr/X11/lib/modules/NVIDIA \
     target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/drivers/$(MACH64)/nvidia_drv.so
file path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/drivers/nvidia_drv.so
link path=usr/X11/lib/modules/drivers/$(MACH64)/nvidia_drv.so \
     target=../../NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/drivers/$(MACH64)/nvidia_drv.so \
     $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/modules/drivers/nvidia_drv.so \
     target=../NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/drivers/nvidia_drv.so \
     $(NVIDIA_MEDIATOR)

file path=usr/X11/lib/modules/extensions/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libglx.so.1
file path=usr/X11/lib/modules/extensions/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libglx.so.1
link path=usr/X11/lib/modules/extensions/NVIDIA \
     target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) \
     $(NVIDIA_MEDIATOR)

file path=usr/bin/nvidia-SunOS-bug-report-$(NVIDIA_DRIVER_MAJOR_VERSION).sh
link path=usr/bin/nvidia-SunOS-bug-report.sh \
     target=nvidia-SunOS-bug-report-$(NVIDIA_DRIVER_MAJOR_VERSION).sh $(NVIDIA_MEDIATOR)

file path=usr/bin/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION)
link path=usr/bin/nvidia-settings \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)
file path=usr/bin/nvidia-xconfig-$(NVIDIA_DRIVER_MAJOR_VERSION)
link path=usr/bin/nvidia-xconfig \
     target=nvidia-xconfig-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/dt/appconfig/appmanager/C/Desktop_Apps/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION)
link path=usr/dt/appconfig/appmanager/C/Desktop_Apps/nvidia-settings \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l.bm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l.pm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l_m.bm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m.bm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m.pm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m_m.bm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t.bm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t.pm
file path=usr/dt/appconfig/icons/C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t_m.bm
link path=usr/dt/appconfig/icons/C/nvidia-settings.l.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l.bm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.l.pm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l.pm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.l_m.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.l_m.bm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.m.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m.bm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.m.pm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m.pm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.m_m.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.m_m.bm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.t.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t.bm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.t.pm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t.pm $(NVIDIA_MEDIATOR)
link path=usr/dt/appconfig/icons/C/nvidia-settings.t_m.bm \
     target=../C-NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.t_m.bm $(NVIDIA_MEDIATOR)

file path=usr/dt/appconfig/types/C/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).dt
link path=usr/dt/appconfig/types/C/nvidia-settings.dt \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).dt $(NVIDIA_MEDIATOR)

file path=usr/lib/libnvidia-cfg-$(NVIDIA_DRIVER_MAJOR_VERSION).so.1
link path=usr/lib/libnvidia-cfg.so.1 \
     target=libnvidia-cfg-$(NVIDIA_DRIVER_MAJOR_VERSION).so.1 $(NVIDIA_MEDIATOR)

file path=usr/share/applications/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).desktop
link path=usr/share/applications/nvidia-settings.desktop \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).desktop $(NVIDIA_MEDIATOR) \
     restart_fmri=svc:/application/desktop-cache/desktop-mime-cache:default
file path=usr/share/control-center-2.0/capplets/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).s10.desktop
link path=usr/share/control-center-2.0/capplets/nvidia-settings.s10.desktop \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).s10.desktop $(NVIDIA_MEDIATOR)

file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/README.txt
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/acknowledgements.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/addressingcapabilities.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/addtlresources.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/appendices.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/commonproblems.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/configlaptop.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/configmultxscreens.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/configtvout.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/configtwinview.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/configuringagp.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/depth30.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/displaydevicenames.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/dpi.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/editxconfig.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/faq.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/flippingubb.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/framelock.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/glxsupport.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/index.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/installationandconfiguration.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/installdriver.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/installedcomponents.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/introduction.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/knownissues.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/minimumrequirements.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/newusertips.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/nvidiasettings.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/openglenvvariables.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/programmingmodes.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/sdi.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/sli.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/supportedchips.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/swapcard.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/vdpausupport.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/xcompositeextension.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/xconfigoptions.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/xineramaglx.html
file path=usr/share/doc/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/html/xrandrextension.html
link path=usr/share/doc/NVIDIA \
     target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

file path=usr/share/icons/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/nvidia-settings.png
link path=usr/share/icons/NVIDIA target=NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR) \
     restart_fmri=svc:/application/desktop-cache/icon-cache:default

file path=usr/share/man/man1/nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).1
link path=usr/share/man/man1/nvidia-settings.1 \
     target=nvidia-settings-$(NVIDIA_DRIVER_MAJOR_VERSION).1 $(NVIDIA_MEDIATOR)
file path=usr/share/man/man1/nvidia-xconfig-$(NVIDIA_DRIVER_MAJOR_VERSION).1
link path=usr/share/man/man1/nvidia-xconfig.1 \
     target=nvidia-xconfig-$(NVIDIA_DRIVER_MAJOR_VERSION).1 $(NVIDIA_MEDIATOR)

link path=usr/share/nvidia \
     target=nvidia-$(NVIDIA_DRIVER_MAJOR_VERSION) $(NVIDIA_MEDIATOR)

##### Links to device nodes not provided in originally packaged FS objects
##### NVIDIA_MEDIATOR added to symlinks just in case to avoid conflicts

link path=dev/nvidia0 target=fbs/nvidia0 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia1 target=fbs/nvidia1 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia10 target=fbs/nvidia10 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia11 target=fbs/nvidia11 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia12 target=fbs/nvidia12 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia13 target=fbs/nvidia13 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia14 target=fbs/nvidia14 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia15 target=fbs/nvidia15 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia2 target=fbs/nvidia2 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia3 target=fbs/nvidia3 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia4 target=fbs/nvidia4 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia5 target=fbs/nvidia5 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia6 target=fbs/nvidia6 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia7 target=fbs/nvidia7 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia8 target=fbs/nvidia8 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidia9 target=fbs/nvidia9 variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)
link path=dev/nvidiactl target=../devices/pseudo/nvidia@255:nvidiactl \
    variant.opensolaris.zone=global pkg.linted=true $(NVIDIA_MEDIATOR)

##### Links to (mediated) shared objects not provided in originally packaged FS objects
##### NVIDIA_MEDIATOR added to some of the symlinks just in case to avoid conflicts

link path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libGL.so \
     target=libGL.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-tls.so \
     target=libnvidia-tls.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libGL.so \
     target=libGL.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-tls.so \
     target=libnvidia-tls.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-wfb.so \
     target=libnvidia-wfb.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/modules/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-wfb.so \
     target=libnvidia-wfb.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/modules/extensions/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libglx.so \
     target=libglx.so.1 $(NVIDIA_MEDIATOR)
link path=usr/X11/lib/modules/extensions/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libglx.so \
     target=libglx.so.1 $(NVIDIA_MEDIATOR)
link path=usr/lib/$(MACH64)/libnvidia-glcore.so.1 \
     target=../../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-glcore.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/$(MACH64)/libnvidia-tls.so \
     target=libnvidia-tls.so.1 $(NVIDIA_MEDIATOR)
link path=usr/lib/$(MACH64)/libnvidia-tls.so.1 \
     target=../../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libnvidia-tls.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/$(MACH64)/libvdpau_nvidia.so \
     target=../../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libvdpau_nvidia.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/$(MACH64)/vdpau/libvdpau_nvidia.so.1 \
     target=../../../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/$(MACH64)/libvdpau_nvidia.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/libnvidia-glcore.so.1 \
     target=../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-glcore.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/libnvidia-tls.so \
     target=libnvidia-tls.so.1 $(NVIDIA_MEDIATOR)
link path=usr/lib/libnvidia-tls.so.1 \
     target=../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libnvidia-tls.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/libvdpau_nvidia.so \
     target=../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libvdpau_nvidia.so.1 \
     $(NVIDIA_MEDIATOR)
link path=usr/lib/vdpau/libvdpau_nvidia.so.1 \
     target=../../X11/lib/NVIDIA-$(NVIDIA_DRIVER_MAJOR_VERSION)/libvdpau_nvidia.so.1 \
     $(NVIDIA_MEDIATOR)

##### Register PCI IDs served by this driver

driver name=nvidia perms="* 0666 root root" \
	alias="pci10de,40" \
	alias="pci10de,41" \
	alias="pci10de,42" \
	alias="pci10de,43" \
	alias="pci10de,44" \
	alias="pci10de,45" \
	alias="pci10de,46" \
	alias="pci10de,47" \
	alias="pci10de,48" \
	alias="pci10de,4e" \
	alias="pci10de,90" \
	alias="pci10de,91" \
	alias="pci10de,92" \
	alias="pci10de,93" \
	alias="pci10de,95" \
	alias="pci10de,98" \
	alias="pci10de,99" \
	alias="pci10de,9d" \
	alias="pci10de,c0" \
	alias="pci10de,c1" \
	alias="pci10de,c2" \
	alias="pci10de,c3" \
	alias="pci10de,c8" \
	alias="pci10de,c9" \
	alias="pci10de,cc" \
	alias="pci10de,cd" \
	alias="pci10de,ce" \
	alias="pci10de,f1" \
	alias="pci10de,f2" \
	alias="pci10de,f3" \
	alias="pci10de,f4" \
	alias="pci10de,f5" \
	alias="pci10de,f6" \
	alias="pci10de,f8" \
	alias="pci10de,f9" \
	alias="pci10de,140" \
	alias="pci10de,141" \
	alias="pci10de,142" \
	alias="pci10de,143" \
	alias="pci10de,144" \
	alias="pci10de,145" \
	alias="pci10de,146" \
	alias="pci10de,147" \
	alias="pci10de,148" \
	alias="pci10de,149" \
	alias="pci10de,14a" \
	alias="pci10de,14c" \
	alias="pci10de,14d" \
	alias="pci10de,14e" \
	alias="pci10de,14f" \
	alias="pci10de,160" \
	alias="pci10de,161" \
	alias="pci10de,162" \
	alias="pci10de,163" \
	alias="pci10de,164" \
	alias="pci10de,165" \
	alias="pci10de,166" \
	alias="pci10de,167" \
	alias="pci10de,169" \
	alias="pci10de,16a" \
	alias="pci10de,191" \
	alias="pci10de,193" \
	alias="pci10de,194" \
	alias="pci10de,197" \
	alias="pci10de,19d" \
	alias="pci10de,19e" \
	alias="pci10de,1d0" \
	alias="pci10de,1d1" \
	alias="pci10de,1d2" \
	alias="pci10de,1d3" \
	alias="pci10de,1d6" \
	alias="pci10de,1d7" \
	alias="pci10de,1d8" \
	alias="pci10de,1da" \
	alias="pci10de,1db" \
	alias="pci10de,1dc" \
	alias="pci10de,1dd" \
	alias="pci10de,1de" \
	alias="pci10de,1df" \
	alias="pci10de,221" \
	alias="pci10de,222" \
	alias="pci10de,240" \
	alias="pci10de,241" \
	alias="pci10de,242" \
	alias="pci10de,244" \
	alias="pci10de,245" \
	alias="pci10de,247" \
	alias="pci10de,290" \
	alias="pci10de,291" \
	alias="pci10de,292" \
	alias="pci10de,293" \
	alias="pci10de,294" \
	alias="pci10de,295" \
	alias="pci10de,297" \
	alias="pci10de,298" \
	alias="pci10de,299" \
	alias="pci10de,29a" \
	alias="pci10de,29b" \
	alias="pci10de,29c" \
	alias="pci10de,29d" \
	alias="pci10de,29e" \
	alias="pci10de,29f" \
	alias="pci10de,2e0" \
	alias="pci10de,2e1" \
	alias="pci10de,2e2" \
	alias="pci10de,2e3" \
	alias="pci10de,2e4" \
	alias="pci10de,38b" \
	alias="pci10de,390" \
	alias="pci10de,391" \
	alias="pci10de,392" \
	alias="pci10de,393" \
	alias="pci10de,394" \
	alias="pci10de,395" \
	alias="pci10de,397" \
	alias="pci10de,398" \
	alias="pci10de,399" \
	alias="pci10de,39c" \
	alias="pci10de,39e" \
	alias="pci10de,3d0" \
	alias="pci10de,3d1" \
	alias="pci10de,3d2" \
	alias="pci10de,3d5" \
	alias="pci10de,3d6" \
	alias="pci10de,400" \
	alias="pci10de,401" \
	alias="pci10de,402" \
	alias="pci10de,403" \
	alias="pci10de,404" \
	alias="pci10de,405" \
	alias="pci10de,406" \
	alias="pci10de,407" \
	alias="pci10de,408" \
	alias="pci10de,409" \
	alias="pci10de,40a" \
	alias="pci10de,40b" \
	alias="pci10de,40c" \
	alias="pci10de,40d" \
	alias="pci10de,40e" \
	alias="pci10de,40f" \
	alias="pci10de,410" \
	alias="pci10de,420" \
	alias="pci10de,421" \
	alias="pci10de,422" \
	alias="pci10de,423" \
	alias="pci10de,424" \
	alias="pci10de,425" \
	alias="pci10de,426" \
	alias="pci10de,427" \
	alias="pci10de,428" \
	alias="pci10de,429" \
	alias="pci10de,42a" \
	alias="pci10de,42b" \
	alias="pci10de,42c" \
	alias="pci10de,42d" \
	alias="pci10de,42e" \
	alias="pci10de,42f" \
	alias="pci10de,531" \
	alias="pci10de,533" \
	alias="pci10de,53a" \
	alias="pci10de,53b" \
	alias="pci10de,53e" \
	alias="pci10de,5e0" \
	alias="pci10de,5e1" \
	alias="pci10de,5e2" \
	alias="pci10de,5e3" \
	alias="pci10de,5e6" \
	alias="pci10de,5e7" \
	alias="pci10de,5ea" \
	alias="pci10de,5eb" \
	alias="pci10de,5ed" \
	alias="pci10de,5f8" \
	alias="pci10de,5f9" \
	alias="pci10de,5fd" \
	alias="pci10de,5fe" \
	alias="pci10de,5ff" \
	alias="pci10de,600" \
	alias="pci10de,601" \
	alias="pci10de,602" \
	alias="pci10de,603" \
	alias="pci10de,604" \
	alias="pci10de,605" \
	alias="pci10de,606" \
	alias="pci10de,607" \
	alias="pci10de,608" \
	alias="pci10de,609" \
	alias="pci10de,60a" \
	alias="pci10de,60b" \
	alias="pci10de,60c" \
	alias="pci10de,60d" \
	alias="pci10de,60f" \
	alias="pci10de,610" \
	alias="pci10de,611" \
	alias="pci10de,612" \
	alias="pci10de,613" \
	alias="pci10de,614" \
	alias="pci10de,615" \
	alias="pci10de,617" \
	alias="pci10de,618" \
	alias="pci10de,619" \
	alias="pci10de,61a" \
	alias="pci10de,61b" \
	alias="pci10de,61c" \
	alias="pci10de,61d" \
	alias="pci10de,61e" \
	alias="pci10de,61f" \
	alias="pci10de,621" \
	alias="pci10de,622" \
	alias="pci10de,623" \
	alias="pci10de,625" \
	alias="pci10de,626" \
	alias="pci10de,627" \
	alias="pci10de,628" \
	alias="pci10de,62a" \
	alias="pci10de,62b" \
	alias="pci10de,62c" \
	alias="pci10de,62d" \
	alias="pci10de,62e" \
	alias="pci10de,630" \
	alias="pci10de,631" \
	alias="pci10de,632" \
	alias="pci10de,635" \
	alias="pci10de,637" \
	alias="pci10de,638" \
	alias="pci10de,63a" \
	alias="pci10de,640" \
	alias="pci10de,641" \
	alias="pci10de,643" \
	alias="pci10de,644" \
	alias="pci10de,645" \
	alias="pci10de,646" \
	alias="pci10de,647" \
	alias="pci10de,648" \
	alias="pci10de,649" \
	alias="pci10de,64a" \
	alias="pci10de,64b" \
	alias="pci10de,64c" \
	alias="pci10de,651" \
	alias="pci10de,652" \
	alias="pci10de,653" \
	alias="pci10de,654" \
	alias="pci10de,655" \
	alias="pci10de,656" \
	alias="pci10de,658" \
	alias="pci10de,659" \
	alias="pci10de,65a" \
	alias="pci10de,65b" \
	alias="pci10de,65c" \
	alias="pci10de,6c0" \
	alias="pci10de,6c4" \
	alias="pci10de,6ca" \
	alias="pci10de,6cd" \
	alias="pci10de,6d1" \
	alias="pci10de,6d2" \
	alias="pci10de,6d8" \
	alias="pci10de,6d9" \
	alias="pci10de,6da" \
	alias="pci10de,6dc" \
	alias="pci10de,6dd" \
	alias="pci10de,6de" \
	alias="pci10de,6df" \
	alias="pci10de,6e0" \
	alias="pci10de,6e1" \
	alias="pci10de,6e2" \
	alias="pci10de,6e3" \
	alias="pci10de,6e4" \
	alias="pci10de,6e5" \
	alias="pci10de,6e6" \
	alias="pci10de,6e7" \
	alias="pci10de,6e8" \
	alias="pci10de,6e9" \
	alias="pci10de,6ea" \
	alias="pci10de,6eb" \
	alias="pci10de,6ec" \
	alias="pci10de,6ef" \
	alias="pci10de,6f1" \
	alias="pci10de,6f8" \
	alias="pci10de,6f9" \
	alias="pci10de,6fa" \
	alias="pci10de,6fb" \
	alias="pci10de,6fd" \
	alias="pci10de,6ff" \
	alias="pci10de,7e0" \
	alias="pci10de,7e1" \
	alias="pci10de,7e2" \
	alias="pci10de,7e3" \
	alias="pci10de,7e5" \
	alias="pci10de,840" \
	alias="pci10de,844" \
	alias="pci10de,845" \
	alias="pci10de,846" \
	alias="pci10de,847" \
	alias="pci10de,848" \
	alias="pci10de,849" \
	alias="pci10de,84a" \
	alias="pci10de,84b" \
	alias="pci10de,84c" \
	alias="pci10de,84d" \
	alias="pci10de,84f" \
	alias="pci10de,860" \
	alias="pci10de,861" \
	alias="pci10de,862" \
	alias="pci10de,863" \
	alias="pci10de,864" \
	alias="pci10de,865" \
	alias="pci10de,866" \
	alias="pci10de,867" \
	alias="pci10de,868" \
	alias="pci10de,869" \
	alias="pci10de,86a" \
	alias="pci10de,86c" \
	alias="pci10de,86d" \
	alias="pci10de,86e" \
	alias="pci10de,86f" \
	alias="pci10de,870" \
	alias="pci10de,871" \
	alias="pci10de,872" \
	alias="pci10de,873" \
	alias="pci10de,874" \
	alias="pci10de,876" \
	alias="pci10de,87a" \
	alias="pci10de,87d" \
	alias="pci10de,87e" \
	alias="pci10de,87f" \
	alias="pci10de,8a0" \
	alias="pci10de,8a2" \
	alias="pci10de,8a3" \
	alias="pci10de,8a4" \
	alias="pci10de,8a5" \
	alias="pci10de,a20" \
	alias="pci10de,a22" \
	alias="pci10de,a23" \
	alias="pci10de,a26" \
	alias="pci10de,a27" \
	alias="pci10de,a28" \
	alias="pci10de,a29" \
	alias="pci10de,a2a" \
	alias="pci10de,a2b" \
	alias="pci10de,a2c" \
	alias="pci10de,a2d" \
	alias="pci10de,a32" \
	alias="pci10de,a34" \
	alias="pci10de,a35" \
	alias="pci10de,a38" \
	alias="pci10de,a3c" \
	alias="pci10de,a60" \
	alias="pci10de,a62" \
	alias="pci10de,a63" \
	alias="pci10de,a64" \
	alias="pci10de,a65" \
	alias="pci10de,a66" \
	alias="pci10de,a67" \
	alias="pci10de,a68" \
	alias="pci10de,a69" \
	alias="pci10de,a6a" \
	alias="pci10de,a6c" \
	alias="pci10de,a6e" \
	alias="pci10de,a6f" \
	alias="pci10de,a70" \
	alias="pci10de,a71" \
	alias="pci10de,a72" \
	alias="pci10de,a73" \
	alias="pci10de,a74" \
	alias="pci10de,a75" \
	alias="pci10de,a76" \
	alias="pci10de,a78" \
	alias="pci10de,a7a" \
	alias="pci10de,a7c" \
	alias="pci10de,ca0" \
	alias="pci10de,ca2" \
	alias="pci10de,ca3" \
	alias="pci10de,ca4" \
	alias="pci10de,ca5" \
	alias="pci10de,ca7" \
	alias="pci10de,ca8" \
	alias="pci10de,ca9" \
	alias="pci10de,cac" \
	alias="pci10de,caf" \
	alias="pci10de,cb0" \
	alias="pci10de,cb1" \
	alias="pci10de,cbc" \
	alias="pci10de,dc0" \
	alias="pci10de,dc4" \
	alias="pci10de,dc5" \
	alias="pci10de,dc6" \
	alias="pci10de,dcd" \
	alias="pci10de,dce" \
	alias="pci10de,dd1" \
	alias="pci10de,dd2" \
	alias="pci10de,dd3" \
	alias="pci10de,dd6" \
	alias="pci10de,dd8" \
	alias="pci10de,dda" \
	alias="pci10de,de0" \
	alias="pci10de,de1" \
	alias="pci10de,de2" \
	alias="pci10de,de3" \
	alias="pci10de,de4" \
	alias="pci10de,de5" \
	alias="pci10de,de8" \
	alias="pci10de,de9" \
	alias="pci10de,dea" \
	alias="pci10de,deb" \
	alias="pci10de,dec" \
	alias="pci10de,ded" \
	alias="pci10de,dee" \
	alias="pci10de,def" \
	alias="pci10de,df0" \
	alias="pci10de,df1" \
	alias="pci10de,df2" \
	alias="pci10de,df3" \
	alias="pci10de,df4" \
	alias="pci10de,df5" \
	alias="pci10de,df6" \
	alias="pci10de,df7" \
	alias="pci10de,df8" \
	alias="pci10de,df9" \
	alias="pci10de,dfa" \
	alias="pci10de,dfc" \
	alias="pci10de,e22" \
	alias="pci10de,e23" \
	alias="pci10de,e24" \
	alias="pci10de,e30" \
	alias="pci10de,e31" \
	alias="pci10de,e3a" \
	alias="pci10de,e3b" \
	alias="pci10de,f00" \
	alias="pci10de,f01" \
	alias="pci10de,fc0" \
	alias="pci10de,fc1" \
	alias="pci10de,fc2" \
	alias="pci10de,fc6" \
	alias="pci10de,fce" \
	alias="pci10de,fd1" \
	alias="pci10de,fd2" \
	alias="pci10de,fd3" \
	alias="pci10de,fd4" \
	alias="pci10de,fd5" \
	alias="pci10de,fd8" \
	alias="pci10de,fd9" \
	alias="pci10de,fe0" \
	alias="pci10de,ff2" \
	alias="pci10de,ffb" \
	alias="pci10de,ffc" \
	alias="pci10de,ffd" \
	alias="pci10de,fff" \
	alias="pci10de,1022" \
	alias="pci10de,1028" \
	alias="pci10de,1040" \
	alias="pci10de,1042" \
	alias="pci10de,1048" \
	alias="pci10de,1049" \
	alias="pci10de,104a" \
	alias="pci10de,1050" \
	alias="pci10de,1051" \
	alias="pci10de,1052" \
	alias="pci10de,1054" \
	alias="pci10de,1055" \
	alias="pci10de,1056" \
	alias="pci10de,1057" \
	alias="pci10de,1058" \
	alias="pci10de,1059" \
	alias="pci10de,105a" \
	alias="pci10de,107d" \
	alias="pci10de,1080" \
	alias="pci10de,1081" \
	alias="pci10de,1082" \
	alias="pci10de,1084" \
	alias="pci10de,1086" \
	alias="pci10de,1087" \
	alias="pci10de,1088" \
	alias="pci10de,1089" \
	alias="pci10de,108b" \
	alias="pci10de,1091" \
	alias="pci10de,1094" \
	alias="pci10de,1096" \
	alias="pci10de,109a" \
	alias="pci10de,109b" \
	alias="pci10de,10c0" \
	alias="pci10de,10c3" \
	alias="pci10de,10c5" \
	alias="pci10de,10d8" \
	alias="pci10de,1140" \
	alias="pci10de,1180" \
	alias="pci10de,1183" \
	alias="pci10de,1185" \
	alias="pci10de,1188" \
	alias="pci10de,1189" \
	alias="pci10de,118f" \
	alias="pci10de,11a0" \
	alias="pci10de,11a1" \
	alias="pci10de,11a7" \
	alias="pci10de,11ba" \
	alias="pci10de,11bc" \
	alias="pci10de,11bd" \
	alias="pci10de,11be" \
	alias="pci10de,11bf" \
	alias="pci10de,11c0" \
	alias="pci10de,11c6" \
	alias="pci10de,1200" \
	alias="pci10de,1201" \
	alias="pci10de,1203" \
	alias="pci10de,1205" \
	alias="pci10de,1206" \
	alias="pci10de,1207" \
	alias="pci10de,1208" \
	alias="pci10de,1210" \
	alias="pci10de,1211" \
	alias="pci10de,1212" \
	alias="pci10de,1213" \
	alias="pci10de,1241" \
	alias="pci10de,1243" \
	alias="pci10de,1244" \
	alias="pci10de,1245" \
	alias="pci10de,1246" \
	alias="pci10de,1247" \
	alias="pci10de,1248" \
	alias="pci10de,1249" \
	alias="pci10de,124b" \
	alias="pci10de,124d" \
	alias="pci10de,1251"
