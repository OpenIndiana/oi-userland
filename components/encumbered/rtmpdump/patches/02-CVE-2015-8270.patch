From 10b580aabcec1621b25518271ba1ab2b018be88e Mon Sep 17 00:00:00 2001
From: Howard Chu <hyc@highlandsun.com>
Date: Mon, 14 Dec 2015 17:49:19 +0000
Subject: [PATCH] Fix AMF3ReadString

Init str on unsupported references
---
 librtmp/amf.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/librtmp/amf.c b/librtmp/amf.c
index 73d1486..9261217 100644
--- a/librtmp/amf.c
+++ b/librtmp/amf.c
@@ -471,6 +471,8 @@ AMF3ReadString(const char *data, AVal *str)
       RTMP_Log(RTMP_LOGDEBUG,
 	  "%s, string reference, index: %d, not supported, ignoring!",
 	  __FUNCTION__, refIndex);
+	  str->av_val = NULL;
+	  str->av_len = 0;
       return len;
     }
   else
-- 
1.9.1

