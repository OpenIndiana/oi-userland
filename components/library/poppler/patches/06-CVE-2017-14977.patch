From 19eedc6fb693a62f305e13079501e3105f869f3c Mon Sep 17 00:00:00 2001
From: Albert Astals Cid <aacid@kde.org>
Date: Sat, 30 Sep 2017 11:12:31 +0200
Subject: Fix crash in broken files

Bug #103045

diff --git a/fofi/FoFiTrueType.cc b/fofi/FoFiTrueType.cc
index 58f604a..4495cb3 100644
--- a/fofi/FoFiTrueType.cc
+++ b/fofi/FoFiTrueType.cc
@@ -451,7 +451,7 @@ int FoFiTrueType::mapNameToGID(char *name) {
 GBool FoFiTrueType::getCFFBlock(char **start, int *length) {
   int i;
 
-  if (!openTypeCFF) {
+  if (!openTypeCFF || !tables) {
     return gFalse;
   }
   i = seekTable("CFF ");
-- 
cgit v0.10.2

