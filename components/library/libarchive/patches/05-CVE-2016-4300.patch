https://github.com/libarchive/libarchive/commit/e79ef306afe332faf22e9b442a2c6b59cb175573

--- libarchive-3.1.2/libarchive/archive_read_support_format_7zip.c	2013-01-14 05:43:45.000000000 +0400
+++ libarchive-3.1.2/libarchive/archive_read_support_format_7zip.c	2016-06-23 11:04:34.580300133 +0300
@@ -2045,6 +2045,9 @@
 				return (-1);
 			if (1000000 < f[i].numUnpackStreams)
 				return (-1);
+			if (unpack_streams > SIZE_MAX - 1000000) {
+				return (-1);
+			}
 			unpack_streams += (size_t)f[i].numUnpackStreams;
 		}
 		if ((p = header_bytes(a, 1)) == NULL)
