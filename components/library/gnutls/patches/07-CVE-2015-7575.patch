From 778b4825c4e9fbd087f6fd5e3c94e547b93ae10e Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@gnutls.org>
Date: Sat, 25 Apr 2015 20:46:15 +0200
Subject: [PATCH] _gnutls_session_sign_algo_enabled: do not consider any values from the extension data to decide acceptable algorithms

---
 lib/ext_signature.c | 17 +----------------
 1 file changed, 1 insertion(+), 16 deletions(-)

diff --git a/lib/ext_signature.c b/lib/ext_signature.c
index dca222f..008b026 100644
--- a/lib/ext_signature.c
+++ b/lib/ext_signature.c
@@ -379,24 +379,9 @@ _gnutls_session_sign_algo_enabled (gnutls_session_t session,
                                    gnutls_sign_algorithm_t sig)
 {
   unsigned i;
-  int ret;
   gnutls_protocol_t ver = gnutls_protocol_get_version (session);
-  sig_ext_st *priv;
-  extension_priv_data_t epriv;
 
-  ret =
-    _gnutls_ext_get_session_data (session,
-                                  GNUTLS_EXTENSION_SIGNATURE_ALGORITHMS,
-                                  &epriv);
-  if (ret < 0)
-    {
-      gnutls_assert ();
-      return 0;
-    }
-  priv = epriv.ptr;
-
-  if (!_gnutls_version_has_selectable_sighash (ver)
-      || priv->sign_algorithms_size == 0)
+  if (!_gnutls_version_has_selectable_sighash (ver))
     /* none set, allow all */
     {
       return 0;
--
libgit2 0.23.4

