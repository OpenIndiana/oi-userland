From 7fdc83b0364005a0b5ed869230dd81752ba022e8 Mon Sep 17 00:00:00 2001
From: Tatsuya Kinoshita <tats@debian.org>
Date: Wed, 27 Dec 2017 06:43:52 +0900
Subject: [PATCH] Prevent invalid columnPos() call in formUpdateBuffer()

Bug-Debian: https://github.com/tats/w3m/issues/89
---
 form.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/form.c b/form.c
index cc5e3d2..bc14d39 100644
--- a/form.c
+++ b/form.c
@@ -482,6 +482,8 @@ formUpdateBuffer(Anchor *a, Buffer *buf, FormItemList *form)
 	rows = form->rows ? form->rows : 1;
 	col = COLPOS(l, a->start.pos);
 	for (c_rows = 0; c_rows < rows; c_rows++, l = l->next) {
+	    if (l == NULL)
+		break;
 	    if (rows > 1) {
 		pos = columnPos(l, col);
 		a = retrieveAnchor(buf->formitem, l->linenumber, pos);
