X-Git-Url: https://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=blobdiff_plain;f=servers%2Fslapd%2Fback-mdb%2Fsearch.c;h=43442aa242216e70b9aac894d59aac82e3cbf97f;hp=301d1a498ceec7597466481e28d54e2a8ad8ef1c;hb=0cee1ffb6021b1aae3fcc9581699da1c85a6dd6e;hpb=431c4af526b18abb4a18c2c4c8655690b753cbe5

diff --git a/servers/slapd/back-mdb/search.c b/servers/slapd/back-mdb/search.c
index 301d1a4..43442aa 100644
--- a/servers/slapd/back-mdb/search.c
+++ b/servers/slapd/back-mdb/search.c
@@ -1066,7 +1066,8 @@ notfound:
 			/* check size limit */
 			if ( get_pagedresults(op) > SLAP_CONTROL_IGNORED ) {
 				if ( rs->sr_nentries >= ((PagedResultsState *)op->o_pagedresults_state)->ps_size ) {
-					mdb_entry_return( op, e );
+					if (e != base)
+						mdb_entry_return( op, e );
 					e = NULL;
 					send_paged_response( op, rs, &lastid, tentries );
 					goto done;
